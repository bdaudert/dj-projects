{% extends "csc_base.html" %}

<meta name="keywords" content="monthly averages, graph, station data, historic data,application, product, tool">
<meta name="description" content="SW-CKN Generates graphs of monthly averages">

{% block content %}

<p align="center">You are here
    <a href="{{HOME_URL}}">HOME></a>
    <a href="{{SW_CKN_URL}}main_map/">RESOURCES></a>
    <a href="{{TOOLS_URL}}">TOOLS></a>
    <a href="{{TOOLS_URL}}station/">STATION TOOLS></a> 
    <a href="{{TOOLS_URL}}station/monthly_aves/">Monthly Averages</a></p>
    
    <table cellpadding="20">
    <td valign="top" width="30%">
        <div id='form'>
            <form method="post" action="">{% csrf_token %}
            <table class="form">
            {%for field in form %}
                <tr>
                    <td>{{field.label}}:</td>
                    <td>{{field}}</td>                                                                                
                    <td><p class="trigger"><img alt="QMark" title="QMark" class="qmark" src="{{MEDIA_URL}}img/QMark.png"></p>                                     
                    {%ifequal field.label "Elements" %}
                        <div class="pop-up">
                        <img alt="ElementChoices" title="ElementChoices" src="{{MEDIA_URL}}img/ACIS_Element_Choices_Stn.png" id="ACISElementChoices" width="450" height="450" border="0">                           </div>
                    {%else%}
                        <div class="pop-up"><p>{{field.help_text}}</p></div>
                    {%endifequal%}
                    </td>
                </tr>
                {%ifequal field.label "Station id"%}
                    <tr><td></td><td><a target="_blank" href="/csc/swcke/apps/station/station_locator/">Station Finder</a></td><td></td></tr>
                {%endifequal%}
               {%if field.errors%}
                 <tr><td></td><td>{{field.errors}}</td><td></td></tr>
                {%endif%}
            {%endfor%}
            </table>
            <input type="submit" value="Submit" name="form"/>
            </form>
        </div>
        <br />
        {%if meta%}
            <p class="pop_link" onClick="ShowHide('metadata')"><u>Click here for station metadata</u></p>
            <div id="metadata" style="display:none;">
                {% for val in meta %}
                    <p>{{val}} </p>
                {%endfor%}
            </div>
        {%endif%}

        {%if results%}
            <p class="pop_link" onClick="ShowHide('averaged_data')"><u>Click here for averaged data<br /> behind this graphic</u></p>
            <div id="averaged_data" width="450" height="450" border="0" style="display:none;">
            {% for el, vals in averaged_data.items%}
                <p>{{el}} : {{vals}}
            {%endfor%}
            </div>
            <a target="_blank" href="{{DATA_URL}}station/?stn_id={{stn_id}}&start_date={{start_date}}&end_date={{end_date}}&elements={{elems}}">Get raw data behind this graphic here!</a>
        {%endif%}
    </td>
    <td valign="top" width="70%">
        <table>
            <td><div id=tool_info_head></div></td><td><div id="how_to_head"></div></td>
        </table>
        <script type="text/javascript">                        
            $("#tool_info_head").load("{{MEDIA_URL}}html/commons.html .tool_info");
        </script>
        <script type="text/javascript">                        
            $("#tool_info").load("{{MEDIA_URL}}html/commons.html #Docu_MON_AVES");
        </script> 

        <div id="how_to_head"></div>
        <script type="text/javascript">            
            $("#how_to_head").load("{{MEDIA_URL}}html/commons.html .tool_how_to");
        </script>
        <div id="how_to" style="display:none;"></div>
        <script type="text/javascript">                        
            $("#how_to").load("{{MEDIA_URL}}html/commons.html #Howto_MON_AVES");
        </script>

        {%if not results%}
            {%if stn_id%}
                <p class="error">Station ID: {{stn_id}}</p>
            {%endif%}
            {%if start_date%}
                <p class="error">Start Date: {{start_date}}</p>
            {%endif%}
            {%if end_date%}
                <p class="error">End Date: {{end_date}}</p>
            {%endif%}
            {%if elements%}
                <p class="error">ACIS Elements: {{elements}}</p>
            {%endif%}       
        {%endif%}

        {%if results%}
            <h2>Plots of Monthly Averages</h2>
            <input type="hidden" id="JSON_URL" name="JSON_URL" value="{{ MEDIA_URL }}tmp/">
            <input type="hidden" id="json_file" name="json_file" value="{{json_file}}">
            <!-- One container per element -->
            {%for result in results%}
                <div align="center" id="container{{forloop.counter}}"style="height:350px;width:100%;"></div>
                <br /> 
            {%endfor%}         
            <script type="text/javascript" src="{{ MEDIA_URL }}js/hc-monthly-aves.js"></script>
        {%endif%}

        {%if error%}
            <p class="error">{{error}}</p>
        {%endif%}
    </td>
    </table>

  <!-- Footer -->
  <!--
  <div id="footer" align="center"></div>
    <script type="text/javascript">                        
    $("#footer").load("{{MEDIA_URL}}html/commons.html .footer-sw-ckn");
    </script>
  -->
{%endblock%}
