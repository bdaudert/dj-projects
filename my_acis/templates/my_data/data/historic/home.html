{% extends "csc_base.html" %}
<meta name="keywords" content="data, station data, historic data, acis">
<meta name="description" content="SW-CKN Historic Station Data">

{%load my_data_filters%}

{% block content %} 

<p align="center">You are here 
<a href="{{URL_PREFIX}}sw_ckn/home/">HOME></a>
<a href="{{URL_PREFIX}}sw_ckn/main/">SW-CKN></a>
<a href="{{URL_PREFIX}}sw_ckn/data/">DATA PORTAL></a>
<a href="{{URL_PREFIX}}sw_ckn/data/historic/">Historic Station Data</a></p>

<div class="container">
    <div class="major-left">
    <br />
    <br />
    {%if not form3_point_ready%}
        {%if not stn_id%}
            <div id='form0'>
                <form method="post" action="">{% csrf_token %}
                <table class="form">
                {%for field in form0_point %}
                    <tr>
                        <td>{{field.label}}:</td>
                        <td>{{field}}</td>
                        <td><p class="trigger"><img src="{{MEDIA_URL}}img/FaceQMark.jpg" class="icon_small"></p>
                        {%ifequal field.label "Elements" %}
                            <div class="pop-up"> 
                            <img src="{{MEDIA_URL}}img/ACIS_Element_Choices.png" id="ACISElementChoices" width="450" height="450" border="0">
                            </div>
                        {%else%}
                            <div class="pop-up"><p>{{field.help_text}}</p></div>
                        {%endifequal%} 
                        </td>
                    </tr>
                    {%if field.errors%}
                     <tr><td></td><td>{{field.errors}}</td><td></td></tr>
                    {%endif%}
                {%endfor%}
                </table>
                <input type="submit" value="Select" name="form0_point"/>
                </form>
            </div>
        {%endif%}

        {%if form1_point_ready %}
        <div id="form1">
            <form method="post" action="">{% csrf_token %}
            <table class="form">
            {%for field in form1_point %}
            {%if field.is_hidden %}
                {{field}}
            {%else%}
                <tr>
                    <td>{{field.label}}:</td>
                    <td>{{field}}</td>                    
                    <td><p class="trigger"><img src="{{MEDIA_URL}}img/FaceQMark.jpg" class="icon_small"></p>                                       {%ifequal field.label "Elements" %}
                        <div class="pop-up" onClick="ShowHide(this)">
                        <img src="{{MEDIA_URL}}img/ACIS_Element_Choices.png" id="ACISElementChoices" width="450" height="450" border="0">
                        </div>
                    {%else%}
                        <div class="pop-up"><p>{{field.help_text}}</p></div>
                    {%endifequal%}
                    </td>
                </tr>
                {%if field.errors%}
                 <tr><td></td><td>{{field.errors}}</td><td></td></tr>
                {%endif%}
            {%endif%}
            {%endfor%}
            </table>
            <input type="submit" value="Submit" name="form1_point"/>
            </form>
        </div>
            </br>
            </br>
        {%endif%}
    {%endif%}
        <br />
    {%if not stn_id %}
      <p class="error">Looking for a particular station?</p>
      <p class="error">Use our station finder!</p>
      <a href="/csc/sw_ckn/station_finder/"><img class="dash_img" src="{{MEDIA_URL}}img/StationFinder.png"></a>
    {%endif%}
    </div>    

    <div class="major-right" style="border:none;">
        <p onClick="ShowHide('Docu_ACIS')"><img class="logo"         
        src="{{MEDIA_URL}}img/ACIS-logo.png"><u>More about the ACIS data sets ...</u></p>
        <div class="docu" id="Docu_ACIS" style="display:none;"></div>
            <script type="text/javascript">                        
            $("#Docu_ACIS").load("{{MEDIA_URL}}html/commons.html #Docu_ACIS");
            </script>

        <div class="docu" id=tool_info_head></div>
        <script type="text/javascript">                        
            $("#tool_info_head").load("{{MEDIA_URL}}html/commons.html .tool_info");
        </script>
        <div class="docu" id="tool_info" style="display:none;">
            <p><ul>
            <li>This tool provides access to daily data from the ACIS system.</li>
            <a target="_blank" href="http://rcc-acis.unl.edu/index.php">ACIS Home Page</a>
            <li>Elements like daily precipitation and daily maximum temperature are directly observed quantities measured at weather stations across the US.</li>
            <li>Elements like daily average temperature, growing, heating and cooling degree days are derived quantities.</li>
            <li>Data for multiple station in a certain region defined by the "Station selection" option are available.</li>
            <li>Queries can be performed for multiple elements at a time.</li>
             <li>Several data formats are available. .xls, .dat, .txt will be downloaded on the user's machine. 
             html and  json formats are displayed on the webpage directly for copy and paste.</li>
            </ul></p>
        </div>

        <div class="docu" id="how_to_head"></div>
        <script type="text/javascript">            
            $("#how_to_head").load("{{MEDIA_URL}}html/commons.html .tool_how_to");
        </script>
        <div id="how_to" style="display:none;">
            <p><ul>
            <li>Choose a station selection method. This will define the type of area of whose station data you are interested in.</li>
            <li>Explanation of station selection choices:</li>
                <ul>
                    <li>Station Selection = "Individual Station". Enter the Station Id of choice. If you don't know your station id, find it here:</li>
                    <a href="{{URL_PREFIX}}sw_ckn/station_finder">Station Finder</a>
                    or here:
                    <a class="docu_long"target="_blank" href="{{ MEDIA_URL }}html/station_id_system_docu.html">More on station Ids</a>
                    <li>Station Selection = "Comma separated list of stations". Enter multiple station ids, separated by a comma.</li>
                    <li>Station Selection = "County FIPS code". Find data for all stations in a US county of your choice.</li>
                    <a target="_blank" href="{{MEDIA_URL}}html/US_FIPS_CountyCodes.htm">List of US FIPS County Codes</a>
                    <li>Station Selection = "Climate Division".  Find data for all stations in a US climate division of your choice.</li>
                    <a target="_blank" href="http://www.ncdc.noaa.gov/temp-and-precip/us-climate-divisions.php">Map and list of US climate divisions</a>
                    <li>Station Selection = "County Warning Area. Find data for all stations in a US county warning area of your choice."</li>
                    <a target="_blank" href="http://www.aprs-is.net/WX/NWSCodes.aspx">List of US County Warning Areas</a>
                    <li>Station Selection = "Basin". Find data for all stations in a US drainage basin of your choice.</li>
                    <a target="_blank" href="http://water.usgs.gov/nawqa/sparrow/wrr97/geograp/huc_name.txt">List of US basin ids</a>
                    <li>Station Selection = "State". Find data for all stations in a US state of your choice.</li>
                    <li>Station Selection = "Bounding Box". Find data for all stations in a bounding box of your choice. A bounding box has four coordinates: West longitude, South latitude, East longitude, North latitude. Please enter them in this order.</li>
                    <li>Start and end date should be 8 characters long and of form yyyymmdd</li>
                </ul>

            <li>Quick list of examples for different station selections.</li>
            <img src="{{MEDIA_URL}}img/ACIS_Area_Codes.png" id="ACIS_Area_Codes" width="450" height="450" border="0"/>
            <li>Enter one or more elements as a comma separated list. Element Choices are:</li>
            <img src="{{MEDIA_URL}}img/ACIS_Element_Choices.png" id="ACISElementChoices" width="450" height="450" border="0"/>
            <li>Choose a data format. .xls, .dat, .txt files will be downloaded on the user's machine. 
            html, json formats are displayed on the webpage directly.</li>
            <li>After making your selections, a second form will appear.</li>
            <li>Depending on your choice of Station Selection, you now choose the stations to be included.</li>
        </div>

        <div id="docu_long"></div>


        {%if stn_id%}
            <p class="error">Please make sure all parameters in the form on the left are correct before you <b>Submit</b> the data request. You chose:</p>
            <p class="error">Station ID: {{stn_id}}</p>
        {%endif%}
        {%if start_date%}
            <p class="error">Start Date: {{start_date}}</p>
        {%endif%}
        {%if end_date%}
            <p class="error">End Date: {{end_date}}</p>
        {%endif%}
        {%if elements%}
            <p class="error">ACIS Elements: {{elements}}</p>
        {%endif%}

        {%if large_request%}
            <p class="error">{{large_request}}</p>
        {%endif%}

       {%if user_info%}
            <p class="error">{{user_info}}</p>
        {%endif%}

        {% if form3_point_ready%}
            <div id='form3'>
                <form method="post" action="">{% csrf_token %}
                <table class="form">
                {%for field in form3_point %}
                    <tr>
                        <td>{{field.label}}:</td>
                        <td>{{field}}</td>
                        <td><p class="trigger"><img src="{{MEDIA_URL}}img/FaceQMark.jpg" class="icon_small"></p>
                        <div class="pop-up"><p>{{field.help_text}}</p></div>
                        </td>
                    </tr>
                    {%if field.errors%}
                     <tr><td></td><td>{{field.errors}}</td><td></td></tr>
                    {%endif%}
                {%endfor%}
                </table>
                <input type="submit" value="Submit" name="form3_point"/>
                </form>
            </div>
        {%endif%}
        {%if results%}
            <p class="error">Results:</p>
            {%if results.errors%}
            <div class="error">Data Request could not be completed. The following error occurred: {{error}}</div>
            {%endif%}
            {%for stn in stn_idx%}
                <h3>STATION NAME:</h3> 
                <b>{{results.stn_names|lookup:stn|safe}}</b>
                <h3>STATION ID,STATION NETWORK PAIRS:</h3>
                {%for id_network in results.stn_ids|lookup:stn %}
                    <b>{{id_network}},</b>
                {%endfor%}
                <h3>Data:</h3> 
                <p class="error"> {{results.stn_errors|lookup:stn}}</p>
                 {%if not json%}   
                    <table>
                    <th>date{{delimiter}}{%for el in results.elements%}{{el}}{{delimiter}}{%endfor%}</th>
                    {%for date_vals in results.stn_data|lookup:stn%}
                        <tr><td>
                        {%for el_val in date_vals%}{{el_val}}{{delimiter}}{%endfor%}
                        </td></tr>
                    {%endfor%}
                    </table>
                {%else%}
                    {{results.stn_data|lookup:stn}}                    
                {%endif%}
            {%endfor%}
        {%endif%}

  <!-- Footer -->
  <div id="footer" align="center"></div>
    <script type="text/javascript">                        
    $("#footer").load("{{MEDIA_URL}}html/commons.html .footer-sw-ckn");
    </script>
 
    </div>
</div>

{%endblock%}
