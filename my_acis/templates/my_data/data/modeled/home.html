{% extends "csc_base.html" %}

<meta name="keywords" content="data, gridded data, modeled data, acis">
<meta name="description" content="SW-CKN Gridded and Modeled Data">

{% block content %} 

<p align="center">You are here 
<a href="{{URL_PREFIX}}sw_ckn/home/">HOME></a>
<a href="{{URL_PREFIX}}sw_ckn/main/">SW-CKN></a>
<a href="{{URL_PREFIX}}sw_ckn/data/">DATA PORTAL></a>
<a href="{{URL_PREFIX}}sw_ckn/data/modeled/">Modeled/Gridded Data</a></p>

<div class="container">
    <h2>ACIS Gridded Data</h2>
    <div class="major-left">
        {%if not form3_grid_ready %}
        {%if not hide_form_0 %}
        <div id='form0'>
            <form method="post" action="">{% csrf_token %}
            <table class="form">
            {%for field in form0_grid %}
                <tr>
                    <td>{{field.label}}:</td>
                    <td>{{field}}</td>
                    <td><p class="trigger"><img src="{{MEDIA_URL}}img/FaceQMark.jpg" class="icon_small"></p>
                    {%ifequal field.label "Elements" %}
                    <div class="pop-up"> 
                        <img src="{{MEDIA_URL}}img/ACIS_Element_Choices.png" id="ACISElementChoices" width="450" height="450" border="0">
                    </div>
                    {%else%}
                    <div class="pop-up"><p>{{field.help_text}}</p></div>
                    {%endifequal%}
                    </td>
                </tr>
                {%if field.errors%}
                 <tr><td></td><td>{{field.errors}}</td><td></td></tr>   
                {%endif%}
            {%endfor%}
            </table>
            <input type="submit" value="Select" name="form0_grid"/>
            </form>
        </div>
        {%endif%}

        {%if form1_grid_ready%}
        <div id="form1">
                <form method="post" action="">{% csrf_token %}
            <table class="form">
            {%for field in form1_grid %}
            {%if field.is_hidden %}
                {{field}}
            {%else%}
                <tr>
                    <td>{{field.label}}:</td>
                    {%if field.label == "Location" %}
                        {%if not map_loc %}
                            <td><input type="text" name="location" id="location"></td>
                        {%else%}
                            <td><input type="text" name="location" id="location" value={{map_loc}}></td>
                        {%endif%}
                    {%else%}
                        <td>{{field}}</td>
                    {%endif%}
                    <td><p class="trigger"><img src="{{MEDIA_URL}}img/FaceQMark.jpg" class="icon_small"></p>
                    {%ifequal field.label "Elements" %}
                        <div class="pop-up">
                        <img src="{{MEDIA_URL}}img/ACIS_Element_Choices.png" id="ACISElementChoices" width="450" height="450" border="0">
                        </div>
                    {%else%}
                        <div class="pop-up"><p>{{field.help_text}}</p></div>
                    {%endifequal%}
                    </td>
                </tr>
                {%if field.errors%}
                 <tr><td></td><td>{{field.errors}}</td><td></td></tr>
                {%endif%}
            {%endif%}
            {%endfor%}
            </table>
            <input type="submit" value="Submit" name="form1_grid"/>
            </form>
        </div>
        </br>
        </br>
        {%endif%}
        {%endif%}
    </div>

    <div class="major-right" style="background-color:X^H#947e6e; border:none;">

        <p onClick="ShowHide('Docu_ACIS')"><img class="logo"         
        src="{{MEDIA_URL}}img/ACIS-logo.png"><u>More about the ACIS data sets ...</u></p>
        <div id="Docu_ACIS" style="display:none;"></div>
            <script type="text/javascript">                        
            $("#Docu_ACIS").load("{{MEDIA_URL}}html/commons.html #Docu_ACIS");
            </script>

        <div id=tool_info_head></div>
        <script type="text/javascript">                        
            $("#tool_info_head").load("{{MEDIA_URL}}html/commons.html .tool_info");
        </script>
        <div id="tool_info" style="display:none;">
            <p><ul>
            <li>This tool provides access to gridded/modeled data from the ACIS system.</li>
            <a target="_blank" href="http://rcc-acis.unl.edu/index.php">ACIS Home Page</a>            
            <li>Data can be obtained for a single grid point, all grid points in a US state or in a user defined bounding box.</li>
            <li>Queries can be performed for multiple elements at a time.</li>
             <li>Several data formats are available. .xls, .dat, .txt will be downloaded on the user's machine.
             html and  json formats are displayed on the webpage directly for copy and paste.</li>
            <li>Information on gridded data sets:</li>
            <p>Quick View: Gridded/Modeled Data in ACIS</p>
            <img class="dash_img" src="{{MEDIA_URL}}img/ACISGridData.png">
            <ul>
                <li>For more information on ACIS gridded data sets NRCC interpolated, NRCC Hi-Res:</li>
                <a href="https://gist.github.com/4197956">GridACIS grids 1 and 3</a>
                <li>For more information and direct access to NARCCAP                         (North American Regional Climate Change Assessment Program) gridded data sets:</li>
                <a href="http://www.earthsystemgrid.org/project/narccap.html">NARCCAP data page</a>
            </ul>
            </ul></p>
        </div>

        <div id="how_to_head"></div>
        <script type="text/javascript">            
            $("#how_to_head").load("{{MEDIA_URL}}html/commons.html .tool_how_to");
        </script>
        <div id="how_to" style="display:none;">
            <p><ul>
            <li>Select a single gridpoint, a US state or a bounding box as your grid selection. 
            This will define the type of area of whose grid data you are interested in</li>
            <li>Enter a comma seperated list of elements. Element choices:
            <img src="{{MEDIA_URL}}img/ACIS_Element_Choices.png" id="ACISElementChoices" 
            width="450" height="450" border="0"/></li>
            <li>Choose you data format. .xls, .dat, .txt will be downloaded on the user's machine.
             html and  json formats are displayed on the webpage directly for copy and paste.</li>
            <li>After making your selection, a second form will appear.</li>
            <li>Start and end date should be 8 characters long and of form yyyymmdd</li>
            <li>Depending on your choice of Grid selection, you now choose the stations to be included.</li>
                <ul>
                    <li>Grid selection = "Point Location". Enter a latitude, longitide of choice. 
                    If you don't know your lat, lon, find it here:</li>
                    <a href="{{URL_PREFIX}}sw_ckn/apps/grid_point_time_series/">Gridpoint time series tool</a>
                    <li>Grid selection = "State". Enter a US state of choice.</li>
                    <li>Station Selection = "Bounding Box". Find data for all stations in a bounding box of your choice. 
                    A bounding box has four coordinates: West longitude, South latitude, East longitude, North latitude. 
                    Please enter them in this order.</li>
                </ul>
            <li>Information on gridded data sets:</li>
            <ul>
                <li>For more information on ACIS gridded data sets NRCC interpolated, NRCC Hi-Res:</li>
                <a href="https://gist.github.com/4197956">GridACIS grids 1 and 3</a>
                <li>For more information and direct access to NARCCAP                         (North American Regional Climate Change Assessment Program) gridded data sets:</li>
                <a href="http://www.earthsystemgrid.org/project/narccap.html">NARCCAP data page</a>
            </ul>
            </ul></p>
        </div>

        {%if location%}
            <p class="error">You chose:</p>
            <p class="error">Lat, Lon: {{location}}</p>
        {%endif%}
        {%if state%}
            <p class="error">You chose:</p>
            <p class="error">State: {{state}}</p>
        {%endif%}
        {%if bbox%}
            <p class="error">You chose:</p>
            <p class="error">Bounding Box: {{bbox}}</p>
        {%endif%}
       {%if start_date%}
            <p class="error">ACIS Elements: {{elements}}</p>
            <p class="error">Start Date: {{start_date}}</p>
        {%endif%}
        {%if end_date%}
            <p class="error">End Date: {{end_date}}</p>
        {%endif%}

        {%if error%}
            {{error}}
        {%endif%}

       {%if large_request%}
            <p class="error">{{large_request}}</p>
        {%endif%}

       {%if user_info%}
            <p class="error">{{user_info}}</p>
        {%endif%}

    {%if need_map%}
        <meta name="viewport" content="initial-scale=1.0, user-scalable=yes" />
        <input type="hidden" id="MEDIA_URL" name="MEDIA_URL" value="{{MEDIA_URL}}">
        <input type="hidden" id="center_lat" name="center_lat" value={{center_lat}}>
        <input type="hidden" id="center_lon" name="center_lon" value={{center_lon}}>
        <input type="hidden" id="zoom_level" name="zoom_level" value="5">
        <input type="hidden" id="app" name="app" value="grid_data">
        <div id="map" style="width: 100%; height:400px;"></div>
        <script type="text/javascript">
            initialize_grid_point_map()
        </script>
    {%endif%} 

        {% if form3_grid_ready%}
            <div id='form3'>
                <form method="post" action="">{% csrf_token %}
                <table class="form">
                {%for field in form3_grid %}
                    <tr>
                        <td>{{field.label}}:</td>
                        <td>{{field}}</td>
                        <td><p class="trigger"><img src="{{MEDIA_URL}}img/FaceQMark.jpg" class="icon_small"></p>
                        <div class="pop-up"><p>{{field.help_text}}</p></div>
                        </td>
                    </tr>
                    {%if field.errors%}
                     <tr><td></td><td>{{field.errors}}</td><td></td></tr>
                    {%endif%}
                {%endfor%}
                </table>
                <input type="submit" value="Submit" name="form3_grid"/>
                </form>
            </div>
        {%endif%}

        {%if grid_data%}
            <!--Link to relevant applications-->
            {%if link_to_clim_sum_map %}
                {%if state%}
                    <a target="_blank" href="{{URL_PREFIX}}sw_ckn/apps/clim_sum_maps/?start_date={{start_date}}&end_date={{end_date}}&element={{element}}&grid={{grid}}&state={{state}}">Generate a climate summary map  for this data set here!</a>
                {%endif%}
                {%if bounding_box%}                    
                    <a target="_blank" href="{{URL_PREFIX}}sw_ckn/apps/clim_sum_maps/?start_date={{start_date}}&end_date={{end_date}}&element={{element}}&grid={{grid}}&bounding_box={{bounding_box}}&">Generate a climate summary map  for this data set here!</a>
                {%endif%}
            {%endif%}
            <br />
            {%if link_to_gp_ts %}
                 <a target="_blank" href="{{URL_PREFIX}}sw_ckn/apps/grid_point_time_series/?lat={{lat}}&lon={{lon}}&start_date={{start_date}}&end_date={{end_date}}&element={{element}}&grid={{grid}}">Generate a time series for this data set here!</a>
            {%endif%}            
            <br />
            <h2>{%for item in file_info%}{{item}}&nbsp;{%endfor%}</h2>
            {%if not json%}
                <p>date{{delimiter}}lat{{delimiter}}lon{{delimiter}}elev{{delimiter}}{%for el in elements%}{{el}}{{delimiter}}{%endfor%}</p>
                {%for row in grid_data%}
                    {%for val  in row%}
                        {{val}}{{delimiter}}
                    {%endfor%}<br />
                {%endfor%}
            {%else%}
                <p>date,lat,lon,elev,{%for el in elements%}{{el}},{%endfor%}</p>
                {{grid_data}}
            {%endif%}
        {%endif%}

  <!-- Footer -->
<!--
  <div id="footer" align="center"></div>
    <script type="text/javascript">                        
    $("#footer").load("{{MEDIA_URL}}html/commons.html .footer-sw-ckn");
    </script>
  </div>
-->
</div>

{%endblock%}
