{% extends "csc_base.html" %}
<meta name="keywords" content="tools, application, gridded data, time series, graph">
<meta name="description" content="SCENIC Historic Station Data">

{%load my_scenic_filters%}

{% block content %} 
<!--
<p align="center">You are here
<a href="{{HOME_URL}}scenic/">Home></a>
<a href="{{TOOLS_URL}}">Data Analysis></a>
<a href="{{GRID_TOOLS_URL}}">Gridded Data Tools></a>
<a href="{{GRID_SPATIAL_SUMMARY_URL}}">Spatial Summary Time Series</a>
</p>
-->

<input type="hidden" id="area_type" name="area_type" value="{{area_type}}">
<input type="hidden" id="host" name="host" value="{{host}}">
<input type="hidden" id="kml_file_path" name="kml_file_path" value="{{kml_file_path}}">
<input type="hidden" id="json_file" name="json_file" value="{{json_file}}">

<!--Set up autofill-->
<script type="text/javascript">set_autofill("{{initial.autofill_list}}");</script>
<script type="text/javascript">
$(function(){
    //On form change, hide results and form errors
    hide_errors_results_on_change('tableTSForm');
});
</script>


<!--Documentation-->
<div id="tool_info" style="display:none;"></div>
<script type="text/javascript">            
    $("#tool_info").load("{{HTML_URL}}/Docu_AREA_TIME_SERIES.html");
</script>
<div id="how_to" style="display:none;">
    <div id="Doc_select_grid_by"></div>
<script type="text/javascript">            
    $("#Doc_select_grid_by").load("{{HTML_URL}}/Docu_select_grid_by.html");
</script>
<div id="Docu_elements"></div>
 <script type="text/javascript">            
    $("#Docu_elements").load("{{HTML_URL}}/Docu_elements_grid_apps.html");
</script>
<div id="Docu_add_degree_days"></div>
<script type="text/javascript">            
    $("#Docu_add_degree_days").load("{{HTML_URL}}/Docu_add_degree_days.html");
</script>
<div id="Docu_degree_days"></div>
<script type="text/javascript">            
    $("#Docu_degree_days").load("{{HTML_URL}}/Docu_degree_days.html");
</script>
<div id="Docu_start_end_date"></div>
 <script type="text/javascript">            
    $("#Docu_start_end_date").load("{{HTML_URL}}/Docu_start_end_date.html");
</script>
<div id="Docu_grid"></div>
<script type="text/javascript">            
    $("#Docu_grid").load("{{HTML_URL}}/Docu_grid.html");
</script>
<div id="Docu_spatial_summary"></div>
<script type="text/javascript">            
    $("#Docu_spatial_summary").load("{{HTML_URL}}/Docu_spatial_summary_grid.html");
</script>
<div id="Docu_show_running_mean"></div>
<script type="text/javascript">            
    $("#Docu_show_running_mean").load("{{HTML_URL}}/Docu_show_running_mean.html");
</script>
<div id="Docu_running_mean_days"></div>
<script type="text/javascript">            
    $("#Docu_running_mean_days").load("{{HTML_URL}}/Docu_running_mean_days.html");
</script>
<div id="Docu_plot_opts" style="display:none;"></div>
<script type="text/javascript">                        
    $("#Docu_plot_opts").load("{{HTML_URL}}/Docu_PLOT_OPTS_AREA_TS.html");
</script>
</div>

<table>
<td valign="bottom" width="300px">
    <input type="submit" value="Start Over" onclick="window.location='{{GRID_SPATIAL_SUMMARY_URL}}'"/>
</td>
<td valign="top" width="650px" align="left">
    <table>
    <td><div id=tool_info_head></div></td>
    <td><div id="how_to_head"></div></td>
    </table>
    <script type="text/javascript">                        
        $("#tool_info_head").load("{{HTML_URL}}/Buttons.html .tool_info");
    </script>
    <script type="text/javascript">            
        $("#how_to_head").load("{{HTML_URL}}/Buttons.html .tool_how_to");
    </script>
</td>
</table>


<table>
<!--LEFT-->
<td valign="top">
    <div id='formTS'>
        <form method="post" id="tableTSForm" action="{{GRID_SPATIAL_SUMMARY_URL}}" onsubmit="show_loading()">{% csrf_token %}
        <table class="form" id="tableTS" >
        {%if user_params_dict.select_grid_by%}
        <tr valign="top" >
        {%else%}
        <tr valign="top">
        {%endif%}
        <td>Select grid by:</td>
        <td>
            <select id="select_grid_by" name="select_grid_by" onchange="set_station_grid_select('area',this);" onfocus="set_station_grid_select('area',this);">
            <option value="location" {{checkbox_vals.location_selected}}>Individual gridpoint</option>
            <option value="state" {{checkbox_vals.state_selected}}>State</option>
            <option value="county" {{checkbox_vals.county_selected}}>County</option>
            <option value="county_warning_area" {{checkbox_vals.county_warning_area_selected}}>County Warning Area</option>
            <option value="climate_division" {{checkbox_vals.climate_division_selected}}>Climate Division</option>
            <option value="basin" {{checkbox_vals.basin_selected}}>Drainage Basin</option>
            <option value="shape" {{checkbox_vals.shape_selected}}>Custom Shape</option>
            </select>
        </td>
        <td><img alt="Help" title="Help" src="{{MEDIA_URL}}img/QMark.png" onclick="ShowPopupDocu('Docu_select_grid_by')">
        <div id="Docu_select_grid_by" style="display:none;"></div>
        <script type="text/javascript">                        
            $("#Docu_select_grid_by").load("{{HTML_URL}}/Docu_select_grid_by.html");
        </script>
        </td>
        </tr>
        {%if user_params_dict.select_grid_by%}
        <tr id="area" valign="top" >
        {%else%}
        <tr id="area" valign="top">
        {%endif%}
        <td id="{{initial.area_type_label}}">{{initial.area_type_label}}: </td>
        <td><input autocomplete="off" type="text" id="{{initial.select_grid_by}}" name="{{initial.select_grid_by}}" value="{{initial.area_type_value}}" list="{{initial.autofill_list}}"></td>
        <td><img alt="Help" title="Help" src="{{MEDIA_URL}}img/QMark.png" class="trigger">
        <div class="pop-up" id="area-pop-up">
            <div id="ht_{{initial.select_grid_by}}"></div>
            <script type="text/javascript">                        
            $("#ht_{{initial.select_grid_by}}").load("{{HTML_URL}}/Docu_help_texts.html #ht_{{initial.select_grid_by}}");
            </script>
        </div>
        </td>
        </tr>
        </tr>
        {%if user_params_dict.elements%}
        <tr id="Els" valign="top" >
        {%else%}
        <tr id="Els" valign="top">
        {%endif%}
        <td id="Elements">Elements: </td>
        <td>
            <select id="elements" name="elements" multiple onchange="update_elements(this)">
            <option value="maxt" {{checkbox_vals.elements_maxt_selected}}>Maximum Temperature</option>
            <option value="mint" {{checkbox_vals.elements_mint_selected}}>Minimum Temperature</option>
            <option value="avgt" {{checkbox_vals.elements_avgt_selected}}>Average Temperature</option>
            <option value="pcpn" {{checkbox_vals.elements_pcpn_selected}}>Precipitation</option>
            <option value="hdd" {{checkbox_vals.elements_hdd_selected}}>Heating Degree Days(65F/18C)</option>
            <option value="cdd" {{checkbox_vals.elements_cdd_selected}}>Cooling Degree Days(65F/18C)</option>
            <option value="gdd" {{checkbox_vals.elements_gdd_selected}}>Growing Degree Days(50F/10C)</option>
            </select>
        </td>
        <td><img class="trigger" alt="Help" title="Help" src="{{MEDIA_URL}}img/QMark.png">
        <div class="pop-up">
        <div id="ht_elements"></div>
        <script type="text/javascript">                        
        $("#ht_elements").load("{{HTML_URL}}/Docu_help_texts.html #ht_elements");
        </script>
        </div>
        </td>
        </tr>
        {%if user_params_dict.start_date%}
        <tr id="add" valign="top" >
        {%else%}
        <tr id="add" valign="top">
        {%endif%}
        <td>Add special degree days: </td>
        <td>
        <select id="add_degree_days" name="add_degree_days" onchange="show_div_if_true(this,'dd') & update_value(this.value)">
            <option value="T" {{checkbox_vals.add_degree_days_T_selected}}>Yes</option>
            <option value="F" {{checkbox_vals.add_degree_days_F_selected}}>No</option>
        </select>
        </td>
        <td><img alt="Help" title="Help" src="{{MEDIA_URL}}img/QMark.png" class="trigger">
        <div class="pop-up">
        <div id="ht_add_degree_days"></div>
        <script type="text/javascript">                        
            $("#ht_add_degree_days").load("{{HTML_URL}}/Docu_help_texts.html #ht_add_degree_days");
        </script>
        </div>
        </td>
        </tr>
        {%if initial.add_degree_days == "T" and not user_params_dict.add_degree_days %}
        <tr id="dd" valign="top">
        {%else%}
        {%if user_params_dict.add_degree_days == "T"%}
        <tr id="dd" valign="top" >
        {%else%}
        <tr id="dd" valign="top" style="display:none">
        {%endif%}
        {%endif%}

        <td id="Degree Days">Degree Days: </td>
        <td><input type="text" id="degree_days" name="degree_days" value="{{initial.degree_days}}" onchange="update_value(this.value)"></td>
        <td><img alt="Help" title="Help" src="{{MEDIA_URL}}img/QMark.png" class="trigger">
        <div class="pop-up">
            <div id="ht_degree_days"></div>
        <script type="text/javascript">                        
            $("#ht_degree_days").load("{{HTML_URL}}/Docu_help_texts.html #ht_degree_days");
            </script>
        </div>
        </td>
        </tr>
        {%if user_params_dict.units%}
        <tr valign="top" >
        {%else%}
        <tr valign="top">
        {%endif%}
        <td>Units: </td>
        <td>
        <select id="units" name="units" onchange="update_value(this.value) & set_degree_days(this.value)">
            <option value="metric" {{checkbox_vals.units_metric_selected}}>Metric</option>
            <option value="english" {{checkbox_vals.units_english_selected}}>English</option>
        </select>
        </td>
        <td><img alt="Help" title="Help" src="{{MEDIA_URL}}img/QMark.png" class="trigger">
        <div class="pop-up">
        <div id="ht_units"></div>
        <script type="text/javascript">                        
            $("#ht_units").load("{{HTML_URL}}/Docu_help_texts.html #ht_units");
        </script>
        </div>
        </td>
        </tr>
        {%if user_params_dict.start_date%}
        <tr valign="top" >
        {%else%}
        <tr valign="top">
        {%endif%}
        <td id="Start Date">Start Date: </td>
        <td><input type="text" id="start_date" name="start_date" value="{{initial.start_date}}" onchange="update_value(this.value)"></td>
        <td><img alt="Help" title="Help" src="{{MEDIA_URL}}img/QMark.png" class="trigger">
        <div class="pop-up">
            <div id="ht_start_date"></div>
            <script type="text/javascript">                        
            $("#ht_start_date").load("{{HTML_URL}}/Docu_help_texts.html #ht_date");
            </script>
        </div>
        </td>
        </tr>
        {%if user_params_dict.end_date%}
        <tr valign="top" >
        {%else%}
        <tr valign="top">
        {%endif%}
        <td id="End Date">End Date: </td>
        <td><input type="text" id="end_date" name="end_date" value="{{initial.end_date}}" onchange="update_value(this.value)"></td>
        <td><img alt="Help" title="Help" src="{{MEDIA_URL}}img/QMark.png" class="trigger">
        <div class="pop-up">
            <div id="ht_end_date"></div>
            <script type="text/javascript">                        
            $("#ht_end_date").load("{{HTML_URL}}/Docu_help_texts.html #ht_date");
            </script>
        </div>
        </td>
        </tr>
        {%if user_params_dict.grid%}
        <tr id="grid_type" valign="top" >
        {%else%}
        <tr id="grid_type" valign="top">
        {%endif%}
        <td>Grid: </td>
        <td>
            <select id="grid" name="grid" onchange="update_value(this.value)">
            <option value="1" {{checkbox_vals.grid_1_selected}}>NRCC Interpolated(1950-Present)</option>
            <option value="3" {{checkbox_vals.grid_3_selected}}>NRCC Int. Hi-Res(2007-Present)</option>
            <option value="21" {{checkbox_vals.grid_21_selected}}>PRISM(1981-Present)</option>
            <option value="4" {{checkbox_vals.grid_4_selected}}>CRCM+NCEP(1970-2000)</option>
            <option value="5" {{checkbox_vals.grid_5_selected}}>CRCM+CCSM(1970-2000,2040-2070)</option>
            <option value="6" {{checkbox_vals.grid_6_selected}}>CRCM+CCSM3(1970-2000,2040-2070)</option>
            <!--<option value="7" {{checkbox_vals.grid_7_selected}}>HRM3+NCEP(1970-2000)</option>-->
            <!--<option value="8" {{checkbox_vals.grid_8_selected}}>HRM3+HadCM3(1970-2000,2040-2070)</option>-->
            <option value="9" {{checkbox_vals.grid_9_selected}}>MM5I+NCEP(1970-2000)</option>
            <option value="10" {{checkbox_vals.grid_10_selected}}>MM5I+CCSM(1970-2000,2040-2070)</option>
            <option value="11" {{checkbox_vals.grid_11_selected}}>RCM3+NCEP(1970-2000)</option>
            <option value="12" {{checkbox_vals.grid_12_selected}}>RCM3+CGCM3(1970-2000,2040-2070)</option>
            <option value="13" {{checkbox_vals.grid_13_selected}}>RCM3+GFDL(1970-2000,2040-2070)</option>
            <option value="14" {{checkbox_vals.grid_14_selected}}>WRFG+NCEP(1970-2000)</option>
            <option value="15" {{checkbox_vals.grid_15_selected}}>WRFG+CCSM(1970-2000,2040-2070)</option>
            <option value="16" {{checkbox_vals.grid_16_selected}}>WRFG+CGCM3(1970-2000,2040-2070)</option>
            </select>
        </td>
        <td><img alt="Help" title="Help" src="{{MEDIA_URL}}img/QMark.png" class="trigger">
        <div class="pop-up">
            <div id="ht_grid"></div>
            <script type="text/javascript">                        
            $("#ht_grid").load("{{HTML_URL}}/Docu_help_texts.html #ht_grid");
            </script>
        </div>
        </td>
        </tr>
        {%if user_params_dict.spatial_summary%}
        <tr valign="top" >
        {%else%}
        <tr valign="top">
        {%endif%}
        <td>Spatial Summary: </td>
        <td>
            <select id="spatial_summary" name="spatial_summary" onchange="update_value(this.value)">
            <option value="max" {{checkbox_vals.spatial_summary_max_selected}}>Maximum</option>
            <option value="min" {{checkbox_vals.spatial_summary_min_selected}}>Minimum</option>
            <option value="mean" {{checkbox_vals.spatial_summary_mean_selected}}>Mean</option>
            <option value="sum" {{checkbox_vals.spatial_summary_sum_selected}}>Sum</option>
            </select>
        </td>
        <td><img alt="Help" title="Help" src="{{MEDIA_URL}}img/QMark.png" class="trigger">
        <div class="pop-up">
            <div id="ht_spatial_summary"></div>
            <script type="text/javascript">                        
            $("#ht_spatial_summary").load("{{HTML_URL}}/Docu_help_texts.html #ht_spatial_summary");
            </script>
        </div>
        </td>
        </tr>
        <tr>
        <td>Show Running Mean?</td>
        <td>
            <select id="show_running_mean" name="show_running_mean" onchange="show_div_if_true(this,'rm_days') & update_value(this.value);">
            <option value="T" {{checkbox_vals.show_running_mean_T_selected}}>Yes</option>
            <option value="F" {{checkbox_vals.show_running_mean_F_selected}}>No</option>
            </select>
        </td>
        <td><img alt="Help" title="Help" src="{{MEDIA_URL}}img/QMark.png" class="trigger">
        <div class="pop-up">
            <div id="ht_show_running_mean"></div>
            <script type="text/javascript">                        
            $("#ht_show_running_mean").load("{{HTML_URL}}/Docu_help_texts.html #ht_show_running_mean");
            </script>
        </div>
        </td>
        </tr>
        {%if initial.show_running_mean == "T"%}
            <tr valign="top" id="rm_days">
        {%else%}
            <tr valign="top" id="rm_days" style="display:none;">
        {%endif%}
        <td>Running Mean Days: </td>
        <td><input type="text" id="running_mean_days" name="running_mean_days" value="{{initial.running_mean_days}}" onchange="update_value(this.value)"></td>
        <td><img alt="Help" title="Help" src="{{MEDIA_URL}}img/QMark.png" class="trigger">
        <div class="pop-up">
            <div id="ht_running_mean_days"></div>
            <script type="text/javascript">                        
            $("#ht_running_mean_days").load("{{HTML_URL}}/Docu_help_texts.html #ht_running_mean_days");
            </script>
        </div>
        </td>
        </tr>
        <tr>
        <td colspan="3"><hr style="border-color:#006666;"></td>
        </tr>
        <tr>
        <td colspan="3" onClick="show_hide_opts('plOpts')"><b><u>Plot Options</u></b>
        <input type="hidden" name="show_plot_opts" id="show_plot_opts" value={{initial.show_plot_opts}}>
        </td>
        </tr>
        <tr>   
        <td colspan="3"><hr style="border-color:#006666;"></td>
        </tr>
        <!--
        {%if initial.show_plot_opts == "T"%}
        <tr valign="top" class="plOpts" style="display:table-row;">
        {%else%}
        <tr valign="top" class="plOpts" style="display:none;">
        {%endif%}-->
        <tr valign="top" style="display:none;">
        <td>Image Size: </td>
        <td>
            <select id="image_size" name="image_size" onchange="update_value(this.value)">
            <option value="small" {{checkbox_vals.image_size_small_selected}}>Small(510px, 290px)</option>
            <option value="medium" {{checkbox_vals.image_size_medium_selected}}>Medium(650px,370px)</option>
            <option value="large" {{checkbox_vals.image_size_large_selected}}>Large(850px, 480px)</option>
            <option value="larger" {{checkbox_vals.image_size_larger_selected}}>Larger(1150px,610x)</option>
            <option value="extra_large" {{checkbox_vals.image_size_extra_large_selected}}>Extra Large(1450px, 820px)</option>
            <option value="wide" {{checkbox_vals.image_size_wide_selected}}>Wide(1850px,610px)</option>
            <option value="wider" {{checkbox_vals.image_size_wider_selected}}>Wider(2450px, 610px)</option>
            <option value="widest" {{checkbox_vals.image_size_widest_selected}}>Widest(3450px,610px)</option>
            </select>
        </td>
        <td><img alt="Help" title="Help" src="{{MEDIA_URL}}img/QMark.png" class="trigger">
        <div class="pop-up">
            <div id="ht_image_size"></div>
            <script type="text/javascript">                        
            $("#ht_image_size").load("{{HTML_URL}}/Docu_help_texts.html #ht_plot_image_size");
            </script>
        </div>
        </td>
        </tr>
        {%if initial.show_plot_opts == "T"%}
        <tr valign="top" class="plOpts" style="display:table-row;">
        {%else%}
        <tr valign="top" class="plOpts" style="display:none;">
        {%endif%}
        <td>Show Major Grid?</td>
        <td>
            <select id="major_grid" name="major_grid" onchange="update_value(this.value)">
            <option value="T" {{checkbox_vals.major_grid_T_selected}}>Yes</option>
            <option value="F" {{checkbox_vals.major_grid_F_selected}}>No</option>
            </select>
        </td>
        <td><img alt="Help" title="Help" src="{{MEDIA_URL}}img/QMark.png" class="trigger">
        <div class="pop-up">
            <div id="ht_major_grid"></div>
            <script type="text/javascript">                        
            $("#ht_major_grid").load("{{HTML_URL}}/Docu_help_texts.html #ht_major_grid");
            </script>
        </div>
        </td>
        </tr>
        {%if initial.show_plot_opts == "T"%}
        <tr valign="top" class="plOpts" style="display:table-row;">
        {%else%}
        <tr valign="top" class="plOpts" style="display:none;">
        {%endif%}
        <td>Show Minor Grid?</td>
        <td>
            <select id="minor_grid" name="minor_grid" onchange="update_value(this.value)">
            <option value="F" {{checkbox_vals.minor_grid_F_selected}}>No</option>
            <option value="T" {{checkbox_vals.minor_grid_T_selected}}>Yes</option>
            </select>
        </td>
        <td><img alt="Help" title="Help" src="{{MEDIA_URL}}img/QMark.png" class="trigger">
        <div class="pop-up">
            <div id="ht_minor_grid"></div>
            <script type="text/javascript">                        
            $("#ht_minor_grid").load("{{HTML_URL}}/Docu_help_texts.html #ht_minor_grid");
            </script>
        </div>
        </td>
        </tr>
        {%if initial.show_plot_opts == "T"%}
        <tr valign="top" class="plOpts" style="display:table-row;">
        {%else%}
        <tr valign="top" class="plOpts" style="display:none;">
        {%endif%}
        <td>Show Connector Line?</td>
        <td>
            <select id="connector_line" name="connector_line" onchange="show_div_if_true(this, 'cl_width') & update_value(this.value);">
            <option value="T" {{checkbox_vals.connector_line_T_selected}}>Yes</option>
            <option value="F" {{checkbox_vals.connector_line_F_selected}}>No</option>
            </select>
        </td>
        <td><img alt="Help" title="Help" src="{{MEDIA_URL}}img/QMark.png" class="trigger">
        <div class="pop-up">
            <div id="ht_connector_line"></div>
            <script type="text/javascript">                        
            $("#ht_connector_line").load("{{HTML_URL}}/Docu_help_texts.html #ht_connector_line");
            </script>
        </div>
        </td>
        </tr>
        {%if initial.connector_line == "T" and initial.show_plot_opts == "T"%}
            <tr valign="top" class="plOpts" id="cl_width">
        {%else%}
            <tr valign="top" class="plOpts" id="cl_width" style="display:none;">
        {%endif%}
        <td id="Connector Line Width">Connector Line width:</td>
        <td><input type="text" id="connector_line_width" name="connector_line_width" value="{{initial.connector_line_width}}" onchange="update_value(this.value)"></td>
        <td><img alt="Help" title="Help" src="{{MEDIA_URL}}img/QMark.png" class="trigger">
        <div class="pop-up">
            <div id="ht_connector_line_width"></div>
            <script type="text/javascript">                        
            $("#ht_connector_line_width").load("{{HTML_URL}}/Docu_help_texts.html #ht_connector_line_width");
            </script>
        </div>
        </td>
        </tr>
        {%if initial.show_plot_opts == "T"%}
        <tr valign="top" class="plOpts" style="display:table-row;">
        {%else%}
        <tr valign="top" class="plOpts" style="display:none;">
        {%endif%}
        <td>Show Markers?</td>
        <td>
            <select name="markers" id="markers" onchange="show_div_if_true(this, 'mk_type') & update_value(this.value);">
            <option value="T" {{checkbox_vals.markers_T_selected}}>Yes</option>
            <option value="F" {{checkbox_vals.markers_F_selected}}>No</option>
            </select>
        </td>
        <td><img alt="Help" title="Help" src="{{MEDIA_URL}}img/QMark.png" class="trigger">
        <div class="pop-up">
            <div id="ht_markers"></div>
            <script type="text/javascript">                        
            $("#ht_markers").load("{{HTML_URL}}/Docu_help_texts.html #ht_markers");
            </script>
        </div>
        </td>
        </tr>
        {%if initial.markers == "T" and initial.show_plot_opts == "T"%}
            <tr valign="top" class="plOpts" id="mk_type">
        {%else%}
            <tr valign="top" class="plOpts" id="mk_type" style="display:none;">
        {%endif%}
        <td>Marker type:</td>
        <td>
            <select id="marker_type" name="marker_type" onchange="update_value(this.value)">
            <option value="diamond" {{checkbox_vals.marker_type_diamond_selected}}>Diamond</option>
            <option value="circle" {{checkbox_vals.marker_type_circle_selected}}>Circle</option>
            <option value="square" {{checkbox_vals.marker_type_square_selected}}>Square</option>
            <option value="triangle" {{checkbox_vals.marker_type_triangle_selected}}>Triangle</option>
            <option value="triangle_down" {{checkbox_vals.marker_type_triangle_down_selected}}>Downward Triangle</option>
            </select>
        </td>
        <td><img alt="Help" title="Help" src="{{MEDIA_URL}}img/QMark.png" class="trigger">
        <div class="pop-up">
            <div id="ht_marker_type"></div>
            <script type="text/javascript">                        
            $("#ht_marker_type").load("{{HTML_URL}}/Docu_help_texts.html #ht_marker_type");
            </script>
        </div>
        </td>
        </tr>
        {%if initial.show_plot_opts == "T"%}
        <tr valign="top" class="plOpts" style="display:table-row;">
        {%else%}
        <tr valign="top" class="plOpts" style="display:none;">
        {%endif%}
        <td id="Vertical Axis Minimum">Vertical axis min:</td>
        <td><input type="text" id="vertical_axis_min" name="vertical_axis_min" value="{{initial.vertical_axis_min}}" onchange="update_value(this.value)"></td>
        <td><img alt="Help" title="Help" src="{{MEDIA_URL}}img/QMark.png" class="trigger">
        <div class="pop-up">
            <div id="ht_vertical_axis_min"></div>
            <script type="text/javascript">                        
            $("#ht_vertical_axis_min").load("{{HTML_URL}}/Docu_help_texts.html #ht_vertical_axis_min");
            </script>
        </div>
        </td>
        </tr>
        {%if initial.show_plot_opts == "T"%}
        <tr valign="top" class="plOpts" style="display:table-row;">
        {%else%}
        <tr valign="top" class="plOpts" style="display:none;">
        {%endif%}
        <td id="Vertical Axis Maximum">Vertical axis max:</td>
        <td><input type="text" id="vertical_axis_max" name="vertical_axis_max" value="{{initial.vertical_axis_max}}" onchange="update_value(this.value)"></td>
        <td><img alt="Help" title="Help" src="{{MEDIA_URL}}img/QMark.png" class="trigger">
        <div class="pop-up">
            <div id="ht_vertical_axis_max"></div>
            <script type="text/javascript">                        
            $("#ht_vertical_axis_max").load("{{HTML_URL}}/Docu_help_texts.html #ht_vertical_axis_max");
            </script>
        </div>
        </td>
        </tr>
        {%if initial.show_plot_opts == "T"%}
        <tr class="plOpts" style="display:table-row;">
        {%else%}
        <tr class="plOpts" style="display:none;">
        {%endif%}
        </table>
        <input type="submit" value="Generate time series" name="formTS">
        <input type="hidden" id="overlay_state" name="overlay_state" value="{{initial.overlay_state}}">
        </form>
    </div>

<!--RIGHT-->
</td>
<td valign="top">
    {%if results%}
    <div class="results">
        <b>Your Parameters</b>:<br />
        <div id="parameters">
        {% for param in display_params_list%}
        {%if forloop.first%}

        <b>{{param.0}}</b>: {{param.1}},<br />

        {%if search_params.shape_coords%}
        <p class="pop_link" onClick="ShowHide('shape_coords')"><u>Show/hide shape coordinates (lon, lat)i</u></p>
        <div id="shape_coords" style="display:none;"><b>Shape coordinates</b>:<br />
            {%for s in search_params.shape_coords%}
            {{s}},
            {%if forloop.counter|divisibleby:2%}<br />{%endif%}
            {%endfor%}
        </div>
        {%endif%}

        {%else%}

        {%if param.0 == "Elements"%}
        <b>{{param.0}}</b>:<br />
        {%for el in search_params.element_list_long%}
        {{el}}, <br />
        {%endfor%}
        {%else%}
        {%if forloop.counter|divisibleby:"2" %}<br />{%endif %}
        <b>{{param.0}}</b>: {{param.1}}{%if not forloop.last%}, {%endif%}
        {%endif%}

        {%endif%}
        {%endfor%}
        </p>
        </div>
    </div>
    <br />
    <div id="Arrow" class="results">
    <table style="display:block;">
    <td valign="top"><b>RESULTS:</b></td>
    <td><img alt="DownArrow" src="{{MEDIA_URL}}img/DownArrow.png" height="300px"></td>
    </table>
    </div>
    {%endif%}

    {%if form_error%}
        <div class="results">
        <p class="error">ERROR: Please correct the form error(s) highlighted in red!</p>
        {%for key, val in form_error.items%}
            <script type="text/javascript">highlight_form_field("{{key}}","{{val}}")</script>
        {%endfor%}
        </div>
    {%endif%}

    {%if user_params_list and not results%}
    <div id="user_params_list">
    <p class="message">
    Please use the form on the left to complete your data request.<br />
    Double check your input parameters and fill out the highlighted form fields.<br />
    Submit the form.<br />
    Your Parameters were:<br />
    {%for key_val in user_params_list%}
    <b>{{key_val.0}}</b>: {{key_val.1}}<br />
    {%endfor%}
    </p>
    </div>
    {%endif%}

    <div id="PolyMap" style="display:none;">
        <div id="panel">
        <div id="color-palette"></div>
            <div>
                <button id="delete-button">Delete Selected Shape</button>
            </div>
        </div>
        {%if lat and lon %}
        <input type="hidden" id="initial_lat" name="initial_lat" value={{lat}}>
        <input type="hidden" id="initial_lon" name="initial_lon" value={{lon}}>
        {%else%}
        <input type="hidden" id="initial_lat" name="initial_lat" value='40'>
        <input type="hidden" id="initial_lon" name="initial_lon" value='-111'>
        {%endif%}
    </div>

    {%if need_gridpoint_map%}
    <div id="GridpointMap" style="display:block;">
    {%else%}
    <div id="GridpointMap" style="display:none;">
    {%endif%}
        {%if lat and lon %}
        <input type="hidden" id="initial_lat" name="initial_lat" value={{lat}}>
        <input type="hidden" id="initial_lon" name="initial_lon" value={{lon}}>
        {%else%}
        <input type="hidden" id="initial_lat" name="initial_lat" value='40'>
        <input type="hidden" id="initial_lon" name="initial_lon" value='-111'>
        {%endif%}
        <div id="map-gridpoint"></div>
        <script type="text/javascript">
        initialize_grid_point_map('data_gridded');
        </script>
    </div>

    {%if need_overlay_map%}
    <div id="OverlayMap" style="display:block;">
    {%else%}
    <div id="OverlayMap" style="display:none;">
    {%endif%}
         <div id="formOverlay" style="display:inherit;">
            <form method="post" action="" onsubmit="show_loading() & set_hidden_fields(this,'tableTSForm')">{% csrf_token %}
            <table class="form" style="margin:0px;">
            <tr>
            <td>State: </td>
            <td>
                <select name="overlay_state" id="overlay_state">
                <option value="al" {{al_selected}}>Alabama</option>
                <option value="ak" {{ak_selected}}>Alaska</option>
                <option value="az" {{az_selected}}>Arizona</option>
                <option value="ar" {{ar_selected}}>Arkansas</option>
                <option value="ca" {{ca_selected}}>California</option>
                <option value="co" {{co_selected}}>Colorado</option>
                <option value="ct" {{ct_selected}}>Connecticut</option>
                <option value="de" {{de_selected}}>Delaware</option>
                <option value="dc" {{dc_selected}}>District of Columbia</option>
                <option value="fl" {{fl_selected}}>Florida</option>
                <option value="ga" {{ga_selected}}>Georgia</option>
                <option value="hi" {{hi_selected}}>Hawaii</option>
                <option value="id" {{id_selected}}>Idaho</option>
                <option value="il" {{il_selected}}>Illinois</option>
                <option value="in" {{in_selected}}>Indiana</option>
                <option value="ia" {{ia_selected}}>Iowa</option>
                <option value="ks" {{ks_selected}}>Kansas</option>
                <option value="ky" {{ky_selected}}>Kentucky</option>
                <option value="la" {{la_selected}}>Louisiana</option>
                <option value="me" {{me_selected}}>Maine</option>
                <option value="md" {{md_selected}}>Maryland</option>
                <option value="ma" {{ma_selected}}>Massachusetts</option>
                <option value="mi" {{mi_selected}}>Michigan</option>
                <option value="mn" {{mn_selected}}>Minnesota</option>
                <option value="ms" {{ms_selected}}>Mississippi</option>
                <option value="mo" {{mo_selected}}>Missouri</option>
                <option value="mt" {{mt_selected}}>Montana</option>
                <option value="ne" {{ne_selected}} >Nebraska</option>
                <option value="nv" {{nv_selected}}>Nevada</option>
                <option value="nh" {{nh_selected}}>New Hampshire</option>
                <option value="nj" {{nj_selected}}>New Jersey</option>
                <option value="nm" {{nm_selected}}>New Mexico</option>
                <option value="ny" {{ny_selected}}>New York</option>
                <option value="nc" {{nc_selected}}>North Carolina</option>
                <option value="nd" {{nd_selected}}>North Dakota</option>
                <option value="oh" {{oh_selected}}>Ohio</option>
                <option value="ok" {{ok_selected}}>Oklahoma</option>
                <option value="or" {{or_selected}}>Oregon</option>
                <option value="pa" {{pa_selected}}>Pennsylvania</option>
                <option value="ri" {{ri_selected}}>Rhode Island</option>
                <option value="sc" {{sc_selected}}>South Carolina</option>
                <option value="sd" {{sd_selected}}>South Dakota</option>
                <option value="tn" {{tn_selected}}>Tennessee</option>
                <option value="tx" {{tx_selected}}>Texas</option>
                <option value="ut" {{ut_selected}}>Utah</option>
                <option value="vt" {{vt_selected}}>Vermont</option>
                <option value="va" {{va_selected}}>Virginia</option>
                <option value="wa" {{wa_selected}}>Washington</option>
                <option value="wv" {{wv_selected}}>West Virginia</option>
                <option value="wi" {{wi_selected}}>Wisconsin</option>
                <option value="wy" {{wy_selected}}>Wyoming</option>
            </select>
            </td>
            <!--
            <td><img alt="Help" title="Help" src="{{MEDIA_URL}}img/QMark.png" class="trigger">
            <div class="pop-up">
                <div id="ht_select_overlay_by">Specify US State</div>
            </div>
            </td>
            </tr>
            -->
            <td><input type="submit" value="Update Map" name="formOverlay"/></td>
            </table>
            <input type="hidden" value="{{initial.select_grid_by}}" name="select_overlay_by" id="select_overlay_by">
            <input type="hidden" value="{{area_type_value}}" name="{{area_type}}">
            <input type="hidden" id="elements_string" value="{{initial.elements_string}}" name="elements" class="elements_string">
            </form>
        </div>
    </div>


    {%if need_overlay_map%}
    {%if overlay_error%}
    <p class="error">{{overlay_error}}</p>
    {%else%}
    <div id="map-overlay"></div>
    <div id="content-window"></div>
    <script type="text/javascript">initialize_map_overlays("{{area_type}}","{{host}}", "{{kml_file_path}}")</script>
    {%endif%} 
    {%endif%}

    {%if error%}
    <p class="error">{{error}}</p>
    {%endif%}

</td></table>

<table align="center">
<td>
    {%if results%}
    <!--Results section-->
    <div id="results" class="results">
    <table>
    <td>
    <p class="pop_link" onClick="ShowHide('printable_table')"><img alt="ShowHide" src ="{{MEDIA_URL}}img/show_hide_button.png"></p>
    </td>
    <td>
    <p onClick="ShowHide('formDownload')"><img alt="Download" title="Download" src="{{MEDIA_URL}}img/download_button.png"></p>
    </td>
    </table>
    <!--Download form-->
    <div id="formDownload" class="form" style="display:none;" align="right">
        <form method="post" action="" onsubmit="show_loading()">{% csrf_token %}
        <table id="tableDownload">
        <tr valign="top">
        <td>Data Format: </td>
        <td>
        <select id="data_format" name="data_format" onchange="set_delimiter(this, 'delim');">
        <option value="clm">Columnar, .txt</option>
        <option value="dlm">Delimited, .dat</option>
        <option value="xl" selected>Excel, .xls</option>
        </select>
        </td>
        <td><img alt="Help" title="Help" src="{{MEDIA_URL}}img/QMark.png" class="trigger">
        <div class="pop-up">
        <div id="ht_data_format"></div>
        <script type="text/javascript">                        
            $("#ht_data_format").load("{{MEDIA_URL}}html/Docu_help_texts.html #ht_data_format");
        </script>
        </div>
        </td>
        </tr>
        <!--Only show when format is clm or dlm, don't show if xl-->
        <tr valign="top" id="delim" style="display:none;">
        <td>Delimiter:</td>
        <td>
        <select id="delimiter" name="delimiter">
        <option value="comma" selected>Comma (,)</option>
        <option value="tab">Tab (    )</option>
        <option value="space">Space ( )</option>
        <option value="colon">Colon (:)</option>
        <option value="pipe">pipe(|)</option>
        </select>
        </td>
        <td><img alt="Help" title="Help" src="{{MEDIA_URL}}img/QMark.png" class="trigger">
        <div class="pop-up">
        <div id="ht_delimiter"></div>
        <script type="text/javascript">                        
            $("#ht_delimiter").load("{{MEDIA_URL}}html/Docu_help_texts.html #ht_delimiter");
        </script>
        </div>
        </td>
        </tr>
        <tr valign="top">
        <td>Outputfile Name: </td>
        <td><input type="text" id="output_file_name" name="output_file_name" value="Output"></td>
        <td><img alt="Help" title="Help" src="{{MEDIA_URL}}img/QMark.png" class="trigger">
        <div class="pop-up">
        <div id="ht_output_file_name"></div>
        <script type="text/javascript">                        
            $("#ht_output_file_name").load("{{MEDIA_URL}}html/Docu_help_texts.html #ht_output_file_name");
        </script>
        </div>
        </td>
        </tr>
        </table>
        <input type="hidden" id="json_file" name="json_file" value="{{json_file}}">
        <input type="submit" value="Download" name="formDownload">
        </form>
    </div><!--end formDownload-->


    <img alt="Print" id="print_button" style="display:none;" title="Print" src="{{MEDIA_URL}}img/print_button.png" onClick="printNode('printable_table')">
    
    <!--Table Data with download and print option-->
    <div id="printable_table" style="display:none;">
        <!--time series table-->
        <!--Header-->
        <b>Parameters</b>:<br />
        <div id="parameters">
        {% for param in display_params_list%}
        {%if forloop.first%}

        <b>{{param.0}}</b>: {{param.1}},<br />        

        {%if search_params.shape_coords%}
        <p class="pop_link" onClick="ShowHide('shape_coords')"><u>Show/hide shape coordinates (lon, lat)i</u></p>
        <div id="shape_coords" style="display:none;"><b>Shape coordinates</b>:<br />
            {%for s in search_params.shape_coords%}
            {{s}},
            {%if forloop.counter|divisibleby:2%}<br />{%endif%}
            {%endfor%}
        </div>
        {%endif%}

        {%else%}

        {%if param.0 == "Elements"%}
        <b>{{param.0}}</b>:<br />
        {%for el in search_params.element_list_long%}
        {{el}}, <br />
        {%endfor%}
        {%else%}
        {%if forloop.counter|divisibleby:"2" %}<br />{%endif %}
        <b>{{param.0}}</b>: {{param.1}}{%if not forloop.last%}, {%endif%}
        {%endif%}
        
        {%endif%}
        {%endfor%}
        </p>
        </div>

        <b>Data</b>:
        <table>
        {%for el_data in results %}
        <td>
        <table>
        {%if forloop.first%}
        <tr><td>Date</td><td>{{search_params.element_list|lookup:0}}</td></tr>
        {%else%}
        <td>{{search_params.element_list|lookup:forloop.counter0}}</td></tr>
        {%endif%}
        {%for data in el_data%}
        <tr>
        {%if forloop.parentloop.first%}
        <td align="right">{{data.0}}</td>
        {%endif%}
        <td align="right">{{data.1}}</td>
        </tr>
        {%endfor%}
        </table>
        </td>
        {%endfor%}
        </table>
    </div><!--printable table-->

    {%for el in search_params.element_list%}
    <div align="center" id="spatial_summary_{{forloop.counter0}}" style="height:{{height}}px;width:{{width}}px;"></div>
    <br />
    {%endfor%}
    <script type="text/javascript" src="{{ MEDIA_URL }}js/hc-spatial-summary-ts.js"></script> 
    {%endif%}<!--if results-->
    </div><!--end results div-->
</td></table>
{%endblock%}
