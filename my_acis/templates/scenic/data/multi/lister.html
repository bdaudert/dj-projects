{% extends "csc_base.html" %}
<meta name="keywords" content="data, station data, gridded data, modeled data, acis">
<meta name="description" content="SCENIC Multi point data lister">

{%load my_scenic_filters%}

{% block content %} 

<!--Documentation-->
<div class="docu" id="tool_info" style="display:none;">
    {% include 'includes/Docu_app_multi_lister.html'%}
</div>
<div id="how_to" style="display:none;">
    <div id="Docu_area_of_interest">{% include 'includes/Docu_area_of_interest.html'%}</div>
    <div id="Docu_data_type">{% include 'includes/Docu_data_type.html'%}</div>
    <div id="Docu_grids">{% include 'includes/Docu_grids.html'%}</div>
    <div id="Docu_temporal_resolution">{% include 'includes/Docu_temporal_resolution.html'%}</div>
    <div id="Docu_elements">{% include 'includes/Docu_elements.html'%}</div>
    <div id="Docu_add_degree_days">{% include 'includes/Docu_add_degree_days.html'%}</div>
    <div id="Docu_degree_days">{% include 'includes/Docu_degree_days.html'%}</div>
    <div id="Docu_units">{% include 'includes/Docu_units.html'%}</div>
    <div id="Docu_start_end_date">{% include 'includes/Docu_start_end_date.html'%}</div>
    <div id="Docu_data_summary">{% include 'includes/Docu_data_summary.html'%}</div>
    <div id="Docu_show_flags">{% include 'includes/Docu_show_flags.html'%}</div>
    <div id="Docu_show_observation_time">{% include 'includes/Docu_show_observation_time.html'%}</div>
    <div id="Docu_data_format">{% include 'includes/Docu_data_format.html'%}</div>
    <div id="Docu_delimiter">{% include 'includes/Docu_delimiter.html'%}</div>
</div><!--End how_to-->

<!---Hidden variables-->
<input type="hidden" id="app_name" name="app_name" value="multi_lister">
<!--For maps-->
<input type="hidden" id="host" name="host" value="{{initial.host}}">
<input type="hidden" id="kml_file_path" name="kml_file_path" value="{{initial.kml_file_path}}">


<!--Set up autofill-->
<script type="text/javascript">set_autofill("{{initial.autofill_list}}");</script>

<!--Button row-->
<div class="row">
    <div class="col-xs-3 col-sm-3 col-md-3 col-lg-3"> 
        <!--Tool Info/Howto-->
        <button type="submit" class="btn btn-primary" onclick="window.location='{{DATA_URL}}multi/lister/'">
            Start Over
        </button>
        {%if results and not form_error%}
        <button type="submit" class="btn btn-primary" onclick="ShowHideTopOfPage()">
            Change Options
        </button>
        {%endif%}
    </div>
    <div class="col-xs-2 col-sm-2 col-md-2 col-lg-2" align="center">
    </div>
    <div class="col-xs-7 col-sm-7 col-md-7 col-lg-7" align="center">
        <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
            <div id=tool_info_head>{% include 'includes/Button_tool_info.html'%}</div>
        </div>
        <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
            <div id="how_to_head">{% include 'includes/Button_how_to.html'%}</div>
        </div>
    </div>
</div><br />


 <!--FORM/MAP/ERRORS-->
{% if not results.data and not results.smry%}
<div id="top_of_page">
{%else%}
<div id="top_of_page" style="display:none">
{%endif%}
    <div class="row" height="100%">
        <!--Form-->
        <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4"> 
            <form method="post" class="main-form" id="DataForm" action="" onsubmit="show_loading()">{% csrf_token %}
            <div class="form-group">
                <button type="submit" class="main-form-button btn btn-large btn-primary pull-left" name="formData" style="width:100%">
                Get Data
                </button>
            </div>
            <input type="hidden" class="overlay_state" name="overlay_state" value="{{initial.overlay_state}}">
            <input type="hidden" name="app_name" value="multi_lister">
            {% include 'includes/area_select.html'%}
            <span  style="display:block;" id="area" valign="bottom">{% include 'includes/area.html'%}</span>
            {% include 'includes/data_type.html'%}
            {%if initial.data_type == "grid"%}
            <span  id="grid_type" style="display:block">{% include 'includes/grids.html'%}</span>
            {% if initial.grid == "21"%}
            <span  id="temp_res" style="display:block">{% include 'includes/temporal_resolution.html'%}</span>
            {%else%}
            <span  id="temp_res" style="display:none">{% include 'includes/temporal_resolution.html'%}</span>
            {%endif%}
            {%else%}
            <span  id="grid_type" style="display:none">{% include 'includes/grids.html'%}</span>
            <span  id="temp_res" style="display:none">{% include 'includes/temporal_resolution.html'%}</span>
            {%endif%}
            <span  style="display:block">{% include 'includes/elements.html'%}</span>
            <span  id="add" valign="top" style="display:block">{% include 'includes/add_degree_days.html'%}</span>
           {%if initial.add_degree_days == "T"%}
                <span id="dd" valign="top" style="display:block">{% include 'includes/degree_days.html'%}</span>
            {%else%}
                <span id="dd" valign="top" style="display:none">{% include 'includes/degree_days.html'%}</span>
            {%endif%}
            <span  style="display:block;">{% include 'includes/units.html'%}</span>
            <span  style="display:block;">{% include 'includes/start_date.html'%}</span>
            <span  style="display:block;">{% include 'includes/end_date.html'%}</span>
            <span  id="data_summ" style="display:block;">{% include 'includes/data_summary.html'%}</span>
            {%if initial.data_summary == "none"%}
            <span id="temp_summary" style="display:none">{% include 'includes/temporal_summary.html'%}</span>
            <span id="spat_summary" style="display:none">{% include 'includes/spatial_summary.html'%}</span>
            <span  id="start_wind" style="display:none;">{% include 'includes/start_window.html'%}</span>
            <span  id="end_wind" style="display:none;">{% include 'includes/end_window.html'%}</span>
            {%endif%}
            {%if initial.data_summary == "temporal_summary"%}
            <span id="temp_summary" style="display:block">{% include 'includes/temporal_summary.html'%}</span>
            <span id="spat_summary" style="display:none">{% include 'includes/spatial_summary.html'%}</span>
            <span  id="start_wind" style="display:none;">{% include 'includes/start_window.html'%}</span>
            <span  id="end_wind" style="display:none;">{% include 'includes/end_window.html'%}</span>
            {%endif%}
            {%if initial.data_summary == "spatial_summary"%}
            <span id="temp_summary" style="display:none">{% include 'includes/temporal_summary.html'%}</span>
            <span id="spat_summary" style="display:block">{% include 'includes/spatial_summary.html'%}</span>
            <span  id="start_wind" style="display:none;">{% include 'includes/start_window.html'%}</span>
            <span  id="end_wind" style="display:none;">{% include 'includes/end_window.html'%}</span>
            {%endif%}
            {%if initial.data_summary == "windowed_data"%}
            <span  id="start_wind" style="display:block;">{% include 'includes/start_window.html'%}</span>
            <span  id="end_wind" style="display:block;">{% include 'includes/end_window.html'%}</span>
            <span id="temp_summary" style="display:none">{% include 'includes/temporal_summary.html'%}</span>
            <span id="spat_summary" style="display:none">{% include 'includes/spatial_summary.html'%}</span>
            {%endif%}
            {%if initial.data_type == "station" and initial.data_summary == "none"%}
            <span  id="flags" style="display:block">{% include 'includes/show_flags.html'%}</span>
            <span  id="obs_time" style="display:block">{% include 'includes/show_observation_time.html'%}</span>
            {%elif initial.data_type == "station" and initial.data_summary == "windowed_data"%}
            <span  id="flags" style="display:block">{% include 'includes/show_flags.html'%}</span>
            <span  id="obs_time" style="display:block">{% include 'includes/show_observation_time.html'%}</span>
            {%else%}
            <span  id="flags" style="display:none">{% include 'includes/show_flags.html'%}</span>
            <span  id="obs_time" style="display:none">{% include 'includes/show_observation_time.html'%}</span>
            {%endif%}
            <span  style="display:block;">{% include 'includes/data_format.html'%}</span>
            {%if initial.data_format != "html"%}
            <span id="out_format" class="out_format" style="display:block;">{% include 'includes/output_format.html'%}</span>
            {%else%}
            <span id="out_format" class="out_format" style="display:none;">{% include 'includes/output_format.html'%}</span>
            {%endif%}
            {%if initial.data_format == "dlm" or initial.data_format == "clm"%}
            <span id="delim" class="delim" style="display:block;">{% include 'includes/delimiter.html'%}</span>
            {%else%}
            <span id="delim" class="delim" style="display:none;">{% include 'includes/delimiter.html'%}</span>
            {%endif%}
            {%if initial.data_format != "html"%}
                <span id="out_file" class="out_file" style="display:block;">{% include 'includes/out_file.html'%}</span>
            {%else%}
                <span id="out_file" class="out_file" style="display:none;">{% include 'includes/out_file.html'%}</span>
            {%endif%}
            <span style="display:none;" class="un">{% include 'includes/user_name.html'%}</span>
            <span style="display:none;" class="ue">{% include 'includes/user_email.html'%}</span> 
            <div class="form-group">
                <button type="submit" class="main-form-button btn btn-large btn-primary pull-left" name="formData" style="width:100%">
                Get Data
                </button>
            </div>
            </form>
        </div><!--col-sm-4-->
        <!--Main: Errors/maps-->
        <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
            <!--Large Request Form-->
            <div id="largeRequestForm" style="display:none">
                {% include 'includes/large_request_form.html'%}
            </div>
            <div id="offlineMessage" style="display:none">{% include 'includes/offline_message.html'%}</div>
            {%if large_request%}
            <script type="text/javascript">ShowPopupDocu('largeRequestForm');</script>
            {%endif%}
            <!--AJAX error-->
            <div style="display:none" class="ajax_error"></div>
            <!--Shape file upload form-->
            <div>{% include 'includes/upload_shape_file.html'%}</div>
            <!--Request errors or results arrow-->
            <div class="results" align="center">
            {%if form_error%}
                {% include 'includes/form_error.html'%}
            {%endif%}

            {%if  run_done and not results.data and not results.smry %}
            {% include 'includes/no_results.html'%}
            {%endif%}
            </div> 
            

            <!--Map section-->
            <!--Overlay maps-->
            {% include 'includes/map-overlay.html'%}
            <!--Polygon map-->
            {% include 'includes/map-polygon.html'%}
        </div><!--col-sm-8-->
    </div><!--row-->
</div><!--top_of_page-->

<!--Results-->
<!--Main Results-->
<div class="row results">
    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"> 
        <div class="results" align="center">    
            <!--Data-->
            <table id="main-table" align="center">
                <td align="center"> 
                {%if results %}
                {%if results.data or results.smry %}
                <div align="left" style="max-width:100%;word-wrap:break-word;">
                {%for key_val in params_display_list%}
                    <b>{{key_val.0}}</b>: {{key_val.1}}; 
                {%endfor%}
                </div><br />
                {%endif%}
                {%endif%}
               
                <!--NO SUMMARY DATA--> 
                {% if not results.error and results.data and not results.smry %}
                {% if initial.data_type == "station" %}
                <p class="message" align="left" style="max-width:70%;word-wrap:break-word;">
                    ACIS Data Flags: M,-9999 = Missing, T = Trace, S = Subsequent, A = Accumulated
                </p><br />
                {% endif%}

                <!--lOOP over results-->
                {% for point_data in results.data %}
                <p class="dataTableInfo" id="dataTableInfo-{{forloop.counter0}}">
                <b>METADATA</b>:<br />
                {% for meta_list in results.meta|lookup:forloop.counter0 %}
                    <b>{{meta_list.0}}</b>: {{meta_list.1}}
                {%endfor%}
                </p>
                <table class="dataTable nowrap" id="dataTable-{{forloop.counter0}}">
                {%for data in point_data%}
                {%if forloop.counter0 == 0%}
                    <thead>
                        <tr>{%for d in data%}<th>{{d}}</th>{%endfor%}</tr>
                    </thead>
                    <tfoot>
                        <tr>{%for d in data%}<th>{{d}}</th>{%endfor%}</tr>
                    </tfoot>
                    <tbody>
                    {%else%}
                        <tr>{%for d in data%}<td>{{d}}</td>{%endfor%}</tr>
                    {%endif%}
                    {%endfor%}
                    </tbody>
                </table>
                {% endfor %}
                {%endif%}<!--if not results.error and results.data and not results.smry-->
                <!--SUMMARY DATA-->
                {%if not results.error and results.smry%}
                <table class="dataTable" id="dataTable-0" border="1"  width="800px">
                {%for s_data in results.smry%}
                {%if forloop.counter0 == 0%}
                    <thead><tr>
                    {%for s in s_data%}
                        <th>{{s}}</th>
                    {%endfor%}
                    </tr></thead>
                    <tfoot><tr>
                    {%for s in s_data%}
                        <th>{{s}}</th>
                    {%endfor%}
                    </tr></tfoot>
                    <tbody>
                {%else%}
                        <tr>
                        {%for s in s_data%}
                            <td>{{s}}</td>
                        {%endfor%}
                        </tr>
                {%endif%}
                {%endfor%}
                    </tbody>
            </table>
            {%endif%}
            </td></table><!--End printable table-->
        </div><!--results-->
    </div><!--col-xs-12-->
</div><!--row-->
{%endblock%}
